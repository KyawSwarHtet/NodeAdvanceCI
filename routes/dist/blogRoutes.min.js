"use strict";var mongoose=require("mongoose"),requireLogin=require("../middlewares/requireLogin"),cleanCache=require("../middlewares/cleanCache"),Blog=mongoose.model("Blog");module.exports=function(e){e.get("/api/blogs/:id",requireLogin,function(r,n){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(Blog.findOne({_user:r.user.id,_id:r.params.id}));case 2:t=e.sent,n.send(t);case 4:case"end":return e.stop()}})}),e.get("/api/blogs",requireLogin,function(r,n){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(Blog.find({_user:r.user.id}).cache({key:r.user.id}));case 2:t=e.sent,console.log("Serving from MongoDB"),n.send(t);case 5:case"end":return e.stop()}})}),e.post("/api/blogs",requireLogin,cleanCache,function(r,n){var t,o,s,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.body,o=t.title,s=t.content,a=new Blog({title:o,content:s,_user:r.user.id}),e.prev=2,e.next=5,regeneratorRuntime.awrap(a.save());case 5:n.send(a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),n.send(400,e.t0);case 11:case"end":return e.stop()}},null,null,[[2,8]])})};
//# sourceMappingURL=blogRoutes.min.js.map
